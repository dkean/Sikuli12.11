<?xml version="1.0" encoding="UTF-8"?>
<project name="build-mac-app" default="all" basedir=".">
  <property name="my.sys" value="Win"/>
  <property name="my.arch" value="${arch}"/>
	<property name="my.build" location="build/${my.sys}"/>
	<property name="my.dist" location="dist/${my.sys}"/>
	<property name="my.util" location="../Ressources/util/${my.sys}"/>
	<property name="my.cp" location="lib"/>
	<property name="my.app" location="${my.dist}/SikuliX"/>
	<property name="my.native" location="../Ressources/natives/${my.sys}/libs${my.arch}"/>

	<target name="all" depends="make-ide">
		<delete dir="${my.app}"/>

		<copy includeemptydirs="yes" todir="${my.app}/libs">
			<fileset dir="Platforms-${my.sys}/libs${my.arch}"/>
		</copy>

		<copy todir="${my.app}/libs">
			<fileset dir="${my.native}" includes="*.dll"/>
			<fileset dir="${my.native}" includes="*.txt"/>
		</copy>

		<copy todir="${my.app}/libs/tessdata">
			<fileset dir="Platforms/tessdata"/>
		</copy>

		<copy todir="${my.app}">
			<fileset dir="${my.cp}">
				<include name="*.jar"/>
				<exclude name="JXGrabKey.jar"/>
			</fileset>
		</copy>

		<copy file="${my.build}/sikuli-script.jar" todir="${my.app}"/>
		<copy file="${my.build}/sikuli-ide.jar" todir="${my.app}"/>

<!--TODO unitl App works-->
	<property name="my.beta" location="${user.home}\Documents"/>
	
	<copy todir="${my.app}">
      <fileset file="${my.util}/sikuli-ide.cmd"/>
      <fileset file="${my.util}/sikuli-script.cmd"/>
    </copy>

    <copy todir="${my.app}">
      <fileset file="${my.util}/readme.txt"/>
    </copy>

    <delete dir ="${my.beta}/SikuliX"/>    
    <copy todir="${my.beta}/SikuliX">
      <fileset dir="${my.app}"/>
    </copy>

    <zip destfile="${my.beta}/SikuliX-1.0Win${my.arch}Beta.zip" basedir="${my.beta}\SikuliX"></zip>

	<!-- unitl App works-->

	</target>

  <target name="make-ide" depends="make-script">
    <ant antfile="build-ide.xml" inheritall="no">
      <property name="sys" value="${my.sys}"/>
    </ant>
  </target>

  <target name="make-script" depends="clean">
    <ant antfile="build-script.xml" inheritall="no">
      <property name="sys" value="${my.sys}"/>
    </ant>
  </target>

  <target name="clean">
    <ant antfile="build-script.xml" target="clean" inheritall="no">
      <property name="sys" value="${my.sys}"/>
    </ant>
    <ant antfile="build-ide.xml" target="clean" inheritall="no">
      <property name="sys" value="${my.sys}"/>
    </ant>
  </target>
</project>
